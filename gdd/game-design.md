# Игровой геймдизайн — Castle Wars

Документ описывает **только реализованные на данный момент** механики с точки зрения игрока и игрового дизайна. Технические детали реализации — в отдельном техническом документе.

---

## 1. Общее описание

- **Жанр**: многопользовательская 2D-игра. Несколько игроков в одной сессии, мир и правила обрабатываются на сервере.
- Игрок управляет персонажем только с помощью мыши: перемещение — выбор персонажа и точки назначения; движение по миру, обход препятствий и взаимодействие с объектами (сундук, ресурс).

---

## 2. Мир и камера

- **Пространство**: 2D-мир. Камера закреплена: центр экрана соответствует точке (0, 0) в мире. При движении персонажа мир «едет» относительно экрана — персонаж остаётся в центре, двигается окружение.
- **Старт**: при входе в игру персонаж появляется в точке (0, 0).

---

## 3. Сущности в мире

### 3.1. Игрок (персонаж)

- Один персонаж на игрока. Круглый коллайдер радиусом **30** пикселей — с ним считаются столкновения и отображается модель.
- Начальная позиция — (0, 0). До первого указания точки движения стоит на месте.

### 3.2. Препятствия (стены, ящики)

- Неподвижные объекты, сквозь которые нельзя пройти. Столкновение с ними останавливает движение по направлению к препятствию (персонаж «упирается»).
- Текущее расположение уровней:

| Позиция (x, y) | Размер (полширина × полувысота) |
|----------------|----------------------------------|
| (200, 0)       | 80 × 20                          |
| (-200, 100)    | 60 × 100                         |
| (150, -150)    | 40 × 40                          |
| (-100, -200)   | 120 × 25                         |

- Визуально — прямоугольники коричневого цвета.

### 3.3. Интерактивные объекты

- **Сундук** и **ресурс**: объекты, с которыми можно взаимодействовать клавишей **E**, если персонаж в радиусе **60** пикселей от центра объекта.
- **Состояние**: изначально «закрыт» (closed). После успешного взаимодействия — «открыт» (open). Обратного перехода нет. Начисление ресурсов, предметов или анимация открытия не реализованы — меняется только состояние и внешний вид.
- Текущее расположение:

| Позиция   | Тип     | Размер  |
|-----------|---------|---------|
| (0, -100) | Сундук  | 25 × 25 |
| (180, -80)| Ресурс  | 20 × 20 |

- Визуально выделяются цветом (золотистый). В состоянии «открыт» — более тёмный оттенок.

---

## 4. Движение

- **Управление**: только мышь. Клавиши WASD и стрелки не используются.
- **Как передвинуть персонажа**:
  1. **Левый клик** по своему персонажу — выбор персонажа (подтверждение, что двигать нужно именно его).
  2. **Правый клик** по месту на карте — персонаж перемещается в указанную точку.
- Игрок сначала щёлкает левой кнопкой по персонажу, затем правой — по цели; персонаж идёт к этой точке.
- **Скорость**: **200** пикселей в секунду (движение к цели).
- **Направление**: персонаж «смотрит» в сторону движения. При остановке направление не сбрасывается — остаётся последнее.

---

## 5. Столкновения

- Персонаж не проходит сквозь препятствия и интерактивные объекты. При столкновении его выталкивает из геометрии препятствия. Движение в других направлениях по-прежнему возможно (скольжение вдоль стены).

---

## 6. Взаимодействие (Interact)

- **Клавиша**: **E**.
- **Условие**: рядом с персонажем есть интерактивный объект (сундук или ресурс) в состоянии «закрыт». Ближайший такой объект в радиусе **60** пикселей считается целью.
- **Эффект**: состояние объекта меняется на «открыт», визуал обновляется. Других игровых эффектов (ресурс, предмет, квест) пока нет.
- **Подсказка**: при приближении к закрытому интерактиву внизу экрана показывается текст «E — взаимодействовать».

---

## 7. Визуализация и интерфейс

- **Свой персонаж**: зелёный круг со стрелкой направления.
- **Другие игроки**: синий круг со стрелкой направления.
- **Препятствия**: коричневые прямоугольники.
- **Интерактивы**: золотистые прямоугольники; при открытии — темнее.
- **UI**: статус подключения (Status), количество игроков в сессии (Players), подсказка «E — взаимодействовать» при возможности взаимодействия.
- Отрисовка подстраивается под размер окна браузера, фон тёмно-серый.

---

## 8. Сессия и игроки

- При подключении к игре игрок попадает в общую комнату (или создаётся новая). В мире появляется его персонаж и персонажи уже подключённых игроков.
- При выходе из комнаты персонаж исчезает из мира. Переподключение к той же сессии и сохранение прогресса при обрыве соединения не реализованы.

---

*Документ описывает состояние на момент реализации: движение, коллизии, препятствия, интерактивы (E), синхронизация нескольких игроков.*
